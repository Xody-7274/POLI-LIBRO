<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3.3 Segmentación de Memoria</title>
    <link rel="icon" type="image/png" href="logoescom.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /*
        Aquí comienza un bloque de estilos CSS para definir la apariencia de la página.
        Incluye:
        - Variables de color (--primary, --secondary, etc.) para un diseño consistente.
        - Estilos base para todos los elementos (*).
        - Estilos para el cuerpo de la página (body), incluyendo un fondo degradado.
        - Diseño de componentes específicos como botones flotantes, menú lateral, contenedor principal,
          encabezados, secciones, tablas, bloques de código, tarjetas de actividad, pie de página, etc.
        - Media Queries (@media) para adaptar el diseño a pantallas más pequeñas (diseño responsivo).
        */
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --success: #2ecc71;
            --warning: #f39c12;
            --card-bg: rgba(255, 255, 255, 0.05);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a3a, #2c3e50);
            color: var(--light);
            min-height: 100vh;
            line-height: 1.7;
        }

        /* Botón flotante de inicio */
        .floating-home-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 4px 20px rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            font-size: 1.5rem;
        }

        .floating-home-btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(52, 152, 219, 0.4);
        }

        /* Menú de navegación lateral */
        .sidebar-nav {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 999;
            transition: transform 0.3s ease;
            transform: translateX(-100%);
            overflow-y: auto;
        }

        .sidebar-nav.active {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 20px;
            background: rgba(52, 152, 219, 0.1);
            border-bottom: 1px solid rgba(52, 152, 219, 0.3);
        }

        .sidebar-title {
            font-size: 1.2rem;
            color: var(--secondary);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .nav-sections {
            padding: 20px 0;
        }

        .nav-section {
            margin-bottom: 15px;
        }

        .nav-section-title {
            padding: 10px 20px;
            font-size: 1rem;
            font-weight: 600;
            color: var(--secondary);
            border-bottom: 1px solid rgba(52, 152, 219, 0.2);
            margin-bottom: 10px;
        }

        .nav-item {
            display: block;
            padding: 12px 20px;
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(52, 152, 219, 0.1);
            border-left-color: var(--secondary);
            padding-left: 25px;
        }

        .nav-item.active {
            background: rgba(52, 152, 219, 0.2);
            border-left-color: var(--secondary);
            color: var(--secondary);
        }

        .nav-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        /* Botón toggle del menú */
        .menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 1001;
            font-size: 1.2rem;
        }

        .menu-toggle:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .menu-toggle.active {
            background: var(--accent);
        }

        /* Indicador de progreso de lectura */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 998;
        }

        .reading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--success));
            width: 0%;
            transition: width 0.1s ease;
        }

        /* Overlay para cerrar el menú */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        /* Contenedor principal con espaciado para botones flotantes */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            transition: margin-left 0.3s ease, margin-right 0.3s ease;
        }
        
        header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .breadcrumb {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            color: var(--gray);
            font-size: 1.1rem;
        }
        
        .breadcrumb a {
            color: var(--secondary);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .breadcrumb a:hover {
            color: white;
            text-decoration: underline;
        }
        
        .breadcrumb span {
            margin: 0 10px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: white;
        }
        
        .subtitle {
            font-size: 1.8rem;
            color: var(--secondary);
            margin-bottom: 20px;
            font-weight: 300;
            text-align: center;
        }
        
        .intro {
            max-width: 900px;
            margin: 0 auto 40px;
            padding: 25px;
            background: var(--card-bg);
            border-radius: 15px;
            border-left: 4px solid var(--secondary);
            text-align: justify;
        }
        
        .section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            scroll-margin-top: 100px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary);
        }
        
        .section-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--secondary);
            margin-right: 15px;
            min-width: 120px;
        }
        
        .section-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: white;
        }
        
        .content {
            padding: 0 10px;
        }
        
        .content h3 {
            font-size: 1.5rem;
            color: var(--secondary);
            margin: 30px 0 15px;
            padding-left: 10px;
            border-left: 3px solid var(--accent);
        }

        .content h4 {
            font-size: 1.3rem;
            color: var(--warning);
            margin: 25px 0 12px;
            padding-left: 8px;
        }
        
        .content p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        .content ul, .content ol {
            padding-left: 30px;
            margin: 20px 0;
        }
        
        .content li {
            margin-bottom: 12px;
        }
        
        .highlight {
            background: rgba(231, 76, 60, 0.15);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .citation {
            font-style: italic;
            color: var(--gray);
            margin: 5px 0 15px 20px;
            border-left: 2px solid var(--secondary);
            padding-left: 10px;
        }
        
        .table-container {
            max-width: 800px;
            margin: 30px auto;
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 0, 0, 0.2);
        }
        
        th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .table-caption {
            text-align: center;
            padding: 10px;
            font-style: italic;
            color: var(--gray);
            background: rgba(0, 0, 0, 0.3);
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
        }
        
        .activity-card {
            background: rgba(46, 204, 113, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin: 40px 0;
            border-left: 4px solid var(--success);
            text-align: center;
        }
        
        .activity-title {
            font-size: 1.8rem;
            color: var(--success);
            margin-bottom: 20px;
        }

        .activity-description {
            margin-bottom: 20px;
        }
        
        .activity-btn {
            display: inline-block;
            background: var(--success);
            color: white;
            padding: 15px 35px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }
        
        .activity-btn:hover {
            background: #27ae60;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        
        .nav-btn {
            display: inline-flex;
            align-items: center;
            background: var(--secondary);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
        }
        
        .nav-btn i {
            margin: 0 8px;
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            color: var(--gray);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Botón de ir arriba */
        .scroll-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--accent);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
            transition: all 0.3s ease;
            opacity: 0;
            visibility: hidden;
            z-index: 999;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background: #c0392b;
            transform: translateY(-3px);
        }
        
        @media (max-width: 768px) {
            .sidebar-nav {
                width: 100%;
            }

            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1.4rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .section-number {
                min-width: 100px;
                font-size: 1.8rem;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
                text-align: center;
                justify-content: center;
            }

            .floating-home-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="reading-progress">
        <div class="reading-progress-bar" id="progressBar"></div>
    </div>

    <button class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </button>

    <a href="index.html" class="floating-home-btn" title="Ir al inicio de Unidades">
        <i class="fas fa-home"></i>
    </a>

    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <nav class="sidebar-nav" id="sidebarNav">
        <div class="sidebar-header">
            <div class="sidebar-title">3.3 Segmentación de Memoria</div>
            <div class="sidebar-subtitle">Modelos y Enfoques</div>
        </div>
        
        <div class="nav-sections">
            <div class="nav-section">
                <div class="nav-section-title">Navegación</div>
                <a href="#inicio" class="nav-item">
                    <i class="fas fa-play-circle"></i>
                    Inicio de la unidad
                </a>
                <a href="index.html" class="nav-item">
                    <i class="fas fa-arrow-left"></i>
                    Menú principal
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Contenido</div>
                <a href="#seccion-3-3-1" class="nav-item" data-section="3-3-1">
                    <i class="fas fa-dice-d6"></i>
                    3.3.1 Segmentación Pura
                </a>
                <a href="#seccion-3-3-2" class="nav-item" data-section="3-3-2">
                    <i class="fas fa-layer-group"></i>
                    3.3.2 Segmentación con Paginación
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Recursos</div>
                <a href="#actividad-aprendizaje" class="nav-item">
                    <i class="fas fa-tasks"></i>
                    Actividad de aprendizaje
                </a>
                <a href="3.2.html" class="nav-item">
                    <i class="fas fa-arrow-left"></i>
                    Anterior: Memoria Virtual
                </a>
            </div>
        </div>
    </nav>

    <button class="scroll-to-top" id="scrollToTop">
        <i class="fas fa-chevron-up"></i>
    </button>

    <div class="container">
        <header id="inicio">
            <div class="breadcrumb">
                <a href="index.html"><i class="fas fa-home"></i> Inicio</a>
                <span>/</span>
                <a href="index.html">Unidad 3</a>
                <span>/</span>
                <span>3.3 Segmentación de Memoria</span>
            </div>
            <h1>3.3 Segmentación de Memoria</h1>
            <div class="subtitle">Organización lógica del espacio de direcciones</div>
        </header>
        
        <div class="intro">
            <h3>INTRODUCCIÓN</h3>
            <p>La segmentación de memoria es otro método clásico para gestionar la memoria. A diferencia de la paginación, que usa bloques de tamaño fijo, la segmentación divide la memoria de un proceso en <span class="highlight">segmentos</span>, que son bloques lógicos de tamaño variable.</p>
            <p class="citation">(Tanenbaum, 2009)</p>
            <p>Cada segmento corresponde a una parte lógica del programa, como el código, la pila o los datos. Esto hace que la segmentación se alinee mejor con la forma en que los programadores estructuran sus aplicaciones. Una dirección virtual se divide en un número de segmento y un desplazamiento.</p>

            <h4>VENTAJAS Y DESVENTAJAS</h4>
            <ul>
                <li><b>Ventajas:</b> Ofrece flexibilidad para que los segmentos crezcan, una protección más sencilla por partes lógicas y la capacidad de compartir segmentos (como librerías) entre procesos.</li>
                <li><b>Desventajas:</b> Su principal problema es la <span class="highlight">fragmentación externa</span>, que ocurre cuando se liberan segmentos de tamaño variable, dejando huecos difíciles de reutilizar en la memoria.</li>
            </ul>
             <p>Por estas desventajas, la segmentación casi nunca se usa sola en los sistemas operativos modernos, sino que se combina con la paginación.</p>
             <p class="citation">(Wolf et al., 2015)</p>
        </div>
        
        <div class="section" id="seccion-3-3-1">
            <div class="section-header">
                <div class="section-number">3.3.1</div>
                <div class="section-title">Implementación de Segmentación Pura</div>
            </div>
            <div class="content">
                <h3>ESTRUCTURA Y FUNCIONAMIENTO</h3>
                <p>La segmentación pura es una técnica que organiza la memoria exclusivamente en segmentos de tamaño variable, sin combinarlos con paginación. En este modelo, cada segmento representa una unidad lógica del programa, como el código, los datos o un arreglo.</p>
                <p class="citation">(Tanenbaum, 2009)</p>
                <p>Cada proceso tiene una <span class="highlight">tabla de segmentos</span>. Cada entrada de esta tabla contiene tres datos clave:</p>
                 <ul>
                    <li><b>Dirección base:</b> Indica dónde empieza el segmento en la memoria física.</li>
                    <li><b>Límite o longitud:</b> Especifica el tamaño del segmento.</li>
                    <li><b>Bits de protección:</b> Controlan los permisos de lectura, escritura o ejecución.</li>
                </ul>
                <p>La MMU utiliza esta información para traducir cada acceso, verificando primero que el desplazamiento no supere el límite del segmento para prevenir accesos ilegales.</p>
                <p class="citation">(Tanenbaum & Woodhull, 2001)</p>
                
                <h3>COMPARACIÓN CON LA PAGINACIÓN</h3>
                <p>La paginación y la segmentación pura tienen fortalezas y debilidades opuestas, como se resume en la siguiente tabla.</p>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ASPECTO</th>
                                <th>SEGMENTACIÓN PURA</th>
                                <th>PAGINACIÓN</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Visión del programador</td>
                                <td>Lógica y natural (código, datos, pila)</td>
                                <td>No natural (bloques fijos)</td>
                            </tr>
                            <tr>
                                <td>Tamaño de bloque</td>
                                <td>Variable</td>
                                <td>Fijo</td>
                            </tr>
                            <tr>
                                <td>Fragmentación Principal</td>
                                <td>Externa (huecos entre segmentos)</td>
                                <td>Interna (espacio desperdiciado en la última página)</td>
                            </tr>
                            <tr>
                                <td>Compartición</td>
                                <td>Fácil (compartir segmentos lógicos)</td>
                                <td>Más compleja (compartir páginas individuales)</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="table-caption">Tabla 1. Comparación entre Segmentación Pura y Paginación.</div>
                </div>
                <p>Debido al serio problema de fragmentación externa, la segmentación pura casi nunca se usa en sistemas modernos. La solución práctica es un modelo híbrido.</p>
                <p class="citation">(Carretero et al., 2001)</p>
            </div>
        </div>
        
        <div class="section" id="seccion-3-3-2">
            <div class="section-header">
                <div class="section-number">3.3.2</div>
                <div class="section-title">Segmentación con Paginación</div>
            </div>
            <div class="content">
                <h3>UN MODELO HÍBRIDO</h3>
                <p>La segmentación con paginación es un modelo que combina lo mejor de ambos enfoques. Su objetivo es ofrecer al programador una visión lógica de la memoria (segmentos) mientras mantiene la eficiencia en la gestión de la memoria física que proporciona la paginación.</p>
                <p class="citation">(Tanenbaum, 2009)</p>
                <p>En este esquema, el espacio de direcciones de un proceso se divide primero en segmentos de tamaño variable, y luego, cada segmento se subdivide en páginas de tamaño fijo.</p>

                <h3>FUNCIONAMIENTO GENERAL</h3>
                <p>Una dirección virtual en este esquema se divide en tres partes:</p>
                <ul>
                    <li><b>Número de segmento (s):</b> Identifica el segmento lógico (ej. código, datos).</li>
                    <li><b>Número de página (p):</b> Indica la página dentro de ese segmento.</li>
                    <li><b>Desplazamiento (d):</b> La posición dentro de esa página.</li>
                </ul>
                <p>El proceso de traducción de la MMU se realiza en dos pasos: primero, consulta la tabla de segmentos para encontrar la tabla de páginas del segmento; luego, usa esa tabla para encontrar el marco de página físico.</p>
                <p class="citation">(Carretero et al., 2001)</p>

                <h4>EJEMPLO PRÁCTICO</h4>
                <p>Imaginemos un proceso con un segmento de código de 20 KB y un tamaño de página de 4 KB. El sistema dividirá este segmento en 5 páginas (20 ÷ 4). Si una dirección virtual es (segmento 0, página 2, desplazamiento 300):</p>
                <ol>
                    <li>La MMU busca la entrada para el <b>Segmento 0</b> en la tabla de segmentos del proceso.</li>
                    <li>Esta entrada apunta a la <b>tabla de páginas</b> del segmento de código.</li>
                    <li>La MMU busca la entrada de la <b>Página 2</b> en esa tabla para encontrar el número de marco físico (ej. marco 45).</li>
                    <li>La dirección física final se calcula como: (dirección de inicio del marco 45) + 300.</li>
                </ol>

                <h4>VENTAJAS Y DESVENTAJAS DEL MODELO HÍBRIDO</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>VENTAJAS</th>
                                <th>DESVENTAJAS</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Combina la organización lógica con la eficiencia física.</td>
                                <td>Implementación mucho más compleja.</td>
                            </tr>
                            <tr>
                                <td>Elimina la fragmentación externa.</td>
                                <td>Mayor sobrecarga de memoria por las tablas.</td>
                            </tr>
                            <tr>
                                <td>Permite protección a nivel de segmento y de página.</td>
                                <td>Cada acceso puede ser más lento (requiere un TLB).</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="table-caption">Tabla 2. Ventajas y desventajas de la segmentación con paginación.</div>
                </div>
                 <p>Aunque los sistemas operativos modernos como Linux y Windows se basan más en la paginación multinivel, la segmentación paginada fue un paso crucial en la evolución de la gestión de memoria.</p>
            </div>
        </div>
        
        <div class="activity-card" id="actividad-aprendizaje">
            <div class="activity-title">
                <i class="fas fa-tasks"></i>
                Actividad de Aprendizaje 3: Segmentación
            </div>
            <p class="activity-description">Evalúa tu comprensión sobre los diferentes enfoques de segmentación de memoria y su combinación con la paginación.</p>
            <a href="actividad_3_3.html" class="activity-btn">
                <i class="fas fa-pencil-alt"></i> Realizar Actividad
            </a>
        </div>
        
        <div class="nav-buttons">
            <a href="3.2.html" class="nav-btn"><i class="fas fa-arrow-left"></i> Volver a 3.2: Memoria Virtual</a>
            <a href="index.html" class="nav-btn">Volver al Menú Principal <i class="fas fa-home"></i></a>
        </div>
        
        <footer>
            <p>Sistemas Operativos - Unidad 3: Administración de Memoria</p>
            <p>Desarrollado para fines educativos - © 2025 | Referencias: Carretero et al. (2001), Tanenbaum (2009), Tanenbaum & Woodhull (2001), Wolf et al. (2015).</p>
        </footer>
    </div>

    <script>
        // Variables globales
        let sidebarOpen = false;

        // Toggle del menú lateral
        const menuToggle = document.getElementById('menuToggle');
        const sidebarNav = document.getElementById('sidebarNav');
        const sidebarOverlay = document.getElementById('sidebarOverlay');

        function toggleSidebar() {
            sidebarOpen = !sidebarOpen;
            
            if (sidebarOpen) {
                sidebarNav.classList.add('active');
                sidebarOverlay.classList.add('active');
                menuToggle.classList.add('active');
                menuToggle.innerHTML = '<i class="fas fa-times"></i>';
                document.body.style.overflow = 'hidden';
            } else {
                sidebarNav.classList.remove('active');
                sidebarOverlay.classList.remove('active');
                menuToggle.classList.remove('active');
                menuToggle.innerHTML = '<i class="fas fa-bars"></i>';
                document.body.style.overflow = 'auto';
            }
            
            updateContainerSpacing();
        }

        menuToggle.addEventListener('click', toggleSidebar);
        sidebarOverlay.addEventListener('click', toggleSidebar);

        // Cerrar menú al hacer clic en un enlace de navegación
        document.querySelectorAll('.nav-item[data-section]').forEach(item => {
            item.addEventListener('click', () => {
                if (window.innerWidth <= 768) {
                    toggleSidebar();
                }
            });
        });

        // Ajustar espaciado del contenedor dinámicamente
        function updateContainerSpacing() {
            const container = document.querySelector('.container');
            
            if (window.innerWidth <= 768) {
                container.style.marginLeft = '20px';
                container.style.marginRight = '20px';
                container.style.padding = '10px';
            } else if (sidebarOpen && window.innerWidth > 768) {
                container.style.marginLeft = '370px';
                container.style.marginRight = '90px';
                container.style.padding = '20px';
            } else {
                container.style.marginLeft = '90px';
                container.style.marginRight = '90px';
                container.style.padding = '20px';
            }
        }

        // Resaltar sección activa en el menú
        function updateActiveSection() {
            const sections = document.querySelectorAll('.section, .intro');
            const navItems = document.querySelectorAll('.nav-item[data-section]');
            
            let currentSection = '';
            
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 150 && rect.bottom >= 150) {
                    currentSection = section.id.replace('seccion-', '');
                }
            });
            
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === currentSection) {
                    item.classList.add('active');
                }
            });
        }

        // Indicador de progreso de lectura
        function updateReadingProgress() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('progressBar').style.width = scrolled + '%';
        }

        // Botón de ir arriba
        const scrollToTopBtn = document.getElementById('scrollToTop');

        function toggleScrollToTopBtn() {
            if (window.pageYOffset > 300) {
                scrollToTopBtn.classList.add('visible');
            } else {
                scrollToTopBtn.classList.remove('visible');
            }
        }

        scrollToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Event listeners
        window.addEventListener('scroll', () => {
            updateActiveSection();
            updateReadingProgress();
            toggleScrollToTopBtn();
        });

        // Desplazamiento suave para enlaces del menú
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                
                if (target) {
                    const offsetTop = target.offsetTop - 100;
                    window.scrollTo({
                        top: offsetTop,
                        behavior: 'smooth'
                    });
                }
            });
        });

        window.addEventListener('resize', () => {
            if (window.innerWidth > 768 && sidebarOpen) {
                toggleSidebar();
            }
            updateContainerSpacing();
        });

        document.addEventListener('DOMContentLoaded', function() {
            updateActiveSection();
            updateReadingProgress();
            updateContainerSpacing();
            
            if (window.innerWidth <= 768) {
                sidebarNav.classList.remove('active');
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && sidebarOpen) {
                toggleSidebar();
            }
            
            if (e.key === 'm' || e.key === 'M') {
                if (!e.ctrlKey && !e.altKey) {
                    toggleSidebar();
                }
            }
        });
    </script>
</body>
</html>