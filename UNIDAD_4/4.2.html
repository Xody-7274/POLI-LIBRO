<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4.2 Implementación del Sistema de Archivos</title>
    <link rel="icon" type="image/png" href="logoescom.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --success: #2ecc71;
            --warning: #f39c12;
            --card-bg: rgba(255, 255, 255, 0.05);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a3a, #2c3e50);
            color: var(--light);
            min-height: 100vh;
            line-height: 1.7;
        }

        .floating-home-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 4px 20px rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            font-size: 1.5rem;
        }

        .floating-home-btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(52, 152, 219, 0.4);
        }

        .sidebar-nav {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 999;
            transition: transform 0.3s ease;
            transform: translateX(-100%);
            overflow-y: auto;
        }

        .sidebar-nav.active {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 20px;
            background: rgba(52, 152, 219, 0.1);
            border-bottom: 1px solid rgba(52, 152, 219, 0.3);
        }

        .sidebar-title {
            font-size: 1.2rem;
            color: var(--secondary);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .nav-sections {
            padding: 20px 0;
        }

        .nav-section {
            margin-bottom: 15px;
        }

        .nav-section-title {
            padding: 10px 20px;
            font-size: 1rem;
            font-weight: 600;
            color: var(--secondary);
            border-bottom: 1px solid rgba(52, 152, 219, 0.2);
            margin-bottom: 10px;
        }

        .nav-item {
            display: block;
            padding: 12px 20px;
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(52, 152, 219, 0.1);
            border-left-color: var(--secondary);
            padding-left: 25px;
        }

        .nav-item.active {
            background: rgba(52, 152, 219, 0.2);
            border-left-color: var(--secondary);
            color: var(--secondary);
        }

        .nav-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 1001;
            font-size: 1.2rem;
        }

        .menu-toggle:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .menu-toggle.active {
            background: var(--accent);
        }

        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 998;
        }

        .reading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--success));
            width: 0%;
            transition: width 0.1s ease;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            transition: margin-left 0.3s ease, margin-right 0.3s ease;
        }
        
        header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .breadcrumb {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            color: var(--gray);
            font-size: 1.1rem;
        }
        
        .breadcrumb a {
            color: var(--secondary);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .breadcrumb a:hover {
            color: white;
            text-decoration: underline;
        }
        
        .breadcrumb span {
            margin: 0 10px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: white;
        }
        
        .subtitle {
            font-size: 1.8rem;
            color: var(--secondary);
            margin-bottom: 20px;
            font-weight: 300;
            text-align: center;
        }
        
        .intro {
            max-width: 900px;
            margin: 0 auto 40px;
            padding: 25px;
            background: var(--card-bg);
            border-radius: 15px;
            border-left: 4px solid var(--secondary);
            text-align: justify;
        }
        
        .section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            scroll-margin-top: 100px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary);
        }
        
        .section-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--secondary);
            margin-right: 15px;
            min-width: 120px;
        }
        
        .section-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: white;
        }
        
        .content {
            padding: 0 10px;
        }
        
        .content h3 {
            font-size: 1.5rem;
            color: var(--secondary);
            margin: 30px 0 15px;
            padding-left: 10px;
            border-left: 3px solid var(--accent);
        }

        .content h4 {
            font-size: 1.3rem;
            color: var(--warning);
            margin: 25px 0 12px;
            padding-left: 8px;
        }
        
        .content p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        .citation {
            font-style: italic;
            color: var(--gray);
            margin: 5px 0 15px 20px;
            border-left: 2px solid var(--secondary);
            padding-left: 10px;
        }

        .figure-container {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        
        .figure-placeholder {
            width: 100%;
            height: 250px;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            margin: 15px 0;
            color: var(--gray);
            font-style: italic;
            flex-direction: column;
        }
        
        .figure-placeholder i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--secondary);
        }
        
        .figure-caption {
            font-style: italic;
            color: var(--gray);
            margin-top: 10px;
        }
        
        .activity-card {
            background: rgba(46, 204, 113, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin: 40px 0;
            border-left: 4px solid var(--success);
            text-align: center;
        }
        
        .activity-title {
            font-size: 1.8rem;
            color: var(--success);
            margin-bottom: 20px;
        }
        
        .activity-btn {
            display: inline-block;
            background: var(--success);
            color: white;
            padding: 15px 35px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }
        
        .activity-btn:hover {
            background: #27ae60;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        
        .nav-btn {
            display: inline-flex;
            align-items: center;
            background: var(--secondary);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
        }
        
        .nav-btn i {
            margin: 0 8px;
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            color: var(--gray);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .scroll-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--accent);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
            transition: all 0.3s ease;
            opacity: 0;
            visibility: hidden;
            z-index: 999;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background: #c0392b;
            transform: translateY(-3px);
        }
        
        @media (max-width: 768px) {
            .sidebar-nav { width: 100%; }
            h1 { font-size: 2rem; }
            .subtitle { font-size: 1.4rem; }
            .section-title { font-size: 1.5rem; }
            .section-number { min-width: 100px; font-size: 1.8rem; }
            .nav-buttons { flex-direction: column; gap: 15px; }
            .nav-btn { width: 100%; text-align: center; justify-content: center; }
            .floating-home-btn { width: 50px; height: 50px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <div class="reading-progress">
        <div class="reading-progress-bar" id="progressBar"></div>
    </div>

    <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>

    <a href="index.html" class="floating-home-btn" title="Ir al inicio de Unidades"><i class="fas fa-home"></i></a>

    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <nav class="sidebar-nav" id="sidebarNav">
        <div class="sidebar-header">
            <div class="sidebar-title">4.2 Implementación</div>
            <div class="sidebar-subtitle">Archivos y Directorios</div>
        </div>
        
        <div class="nav-sections">
            <div class="nav-section">
                <div class="nav-section-title">Navegación</div>
                <a href="#inicio" class="nav-item"><i class="fas fa-play-circle"></i> Inicio de la unidad</a>
                <a href="index.html" class="nav-item"><i class="fas fa-arrow-left"></i> Menú principal</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Contenido</div>
                <a href="#seccion-4-2-1" class="nav-item" data-section="4-2-1"><i class="fas fa-file"></i> 4.2.1 De Archivos</a>
                <a href="#seccion-4-2-2" class="nav-item" data-section="4-2-2"><i class="fas fa-folder"></i> 4.2.2 De Directorios</a>
                <a href="#seccion-4-2-3" class="nav-item" data-section="4-2-3"><i class="fas fa-share-alt"></i> 4.2.3 Archivos Compartidos</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Recursos</div>
                <a href="#actividad-aprendizaje" class="nav-item"><i class="fas fa-tasks"></i> Actividad de aprendizaje</a>
                <a href="4.3.html" class="nav-item"><i class="fas fa-arrow-right"></i> Siguiente: Métodos de Asignación</a>
            </div>
        </div>
    </nav>

    <button class="scroll-to-top" id="scrollToTop"><i class="fas fa-chevron-up"></i></button>

    <div class="container">
        <header id="inicio">
            <div class="breadcrumb">
                <a href="index.html"><i class="fas fa-home"></i> Inicio</a>
                <span>/</span>
                <a href="index.html">Unidad 4</a>
                <span>/</span>
                <span>4.2 Implementación</span>
            </div>
            <h1>4.2 Implementación del Sistema de Archivos</h1>
            <div class="subtitle">Estrategias para organizar, acceder y compartir datos</div>
        </header>
        
        <div class="intro">
            <h3>INTRODUCCIÓN</h3>
            <p>La implementación de archivos constituye un aspecto fundamental dentro del funcionamiento de los sistemas operativos modernos. Esta implementación permite que la información almacenada se organice eficientemente, se acceda de manera óptima y se mantenga disponible incluso después de apagar el equipo.</p>
            <p class="citation">(Stallings, 2018; Silberschatz et al., 2018)</p>
            <p>A continuación se analizan las distintas estrategias que han sido desarrolladas para manejar los bloques de disco y asociarlos correctamente con los archivos. Cada método presenta sus propias ventajas y limitaciones.</p>
             <p class="citation">(Carretero et al., 2001; Tanenbaum & Bos, 2015)</p>
        </div>
        
        <div class="section" id="seccion-4-2-1">
            <div class="section-header">
                <div class="section-number">4.2.1</div>
                <div class="section-title">De Archivos</div>
            </div>
            <div class="content">
                <h4>ASIGNACIÓN CONTIGUA</h4>
                <p>Este esquema consiste en guardar todos los bloques de un archivo en una secuencia continua del disco. Gracias a esta organización lineal, es muy fácil acceder a los datos y se obtiene un alto rendimiento en lectura secuencial, ya que solo se necesita localizar el primer bloque para acceder a todo el archivo.</p>
                <p class="citation">(Stallings, 2018; Carretero et al., 2001)</p>
                <div class="figure-container">
                    <img src="FIGURA1.jpg" alt="Ilustración de asignación contigua inicial" class="imagen-figura1">
                    <div class="figure-caption">Figura 1. Asignación contigua de archivos: Estado inicial con archivos almacenados secuencialmente. </div>
                </div>
                <p>Sin embargo, esta estrategia presenta una gran debilidad: con el tiempo, los discos se fragmentan, llenándose de huecos debido a la eliminación de archivos, lo que complica encontrar espacio para archivos nuevos.</p>
                <p class="citation">(Silberschatz et al., 2018)</p>
                <div class="figure-container">
                    <img src="FIGURA2.jpg" alt="Ilustración de fragmentación externa." class="imagen-figura2">
                    <div class="figure-caption">Figura 2. Fragmentación externa después de eliminaciones (adaptado de Tanenbaum & Bos, 2015) </div>
                </div>

                <h4>ASIGNACIÓN MEDIANTE LISTAS ENLAZADAS</h4>
                <p>Una alternativa más flexible es la asignación mediante listas enlazadas. Cada archivo se compone de una cadena de bloques, donde cada bloque contiene un apuntador al siguiente. Este sistema evita la fragmentación externa y aprovecha cualquier bloque libre.</p>
                <p class="citation">(Tanenbaum & Bos, 2015; Stallings, 2018)</p>
                <div class="figure-container">
                    <img src="FIGURA3.jpg" alt="Ilustración de bloques de archivo enlazados." class="imagen-figura3">
                    <div class="figure-caption">Figura 3. Asignación mediante listas enlazadas (basado en Carretero et al., 2001) </div>
                </div>
                <p>No obstante, el acceso aleatorio se vuelve significativamente más lento, y el espacio usado para los apuntadores reduce la capacidad de almacenamiento de datos en cada bloque.</p>
                <p class="citation">(Tanenbaum & Bos, 2015; Silberschatz et al., 2018)</p>
                
                <h4>ASIGNACIÓN CON TABLA EN MEMORIA (FAT)</h4>
                <p>Para mejorar el método anterior, surgió la FAT (File Allocation Table). Esta tabla guarda en memoria principal la información completa de los apuntadores, permitiendo acceder rápidamente a cualquier bloque sin leerlo previamente desde el disco.</p>
                <p class="citation">(Stallings, 2018; Carretero et al., 2001)</p>
                <div class="figure-container">
                    <img src="FIGURA4.jpg" alt="Ilustración de una tabla FAT." class="imagen-figura4">
                    <div class="figure-caption">Figura 4. Implementación de FAT (File Allocation Table) (adaptado de Silberschatz et al., 2018). </div>
                </div>
                <p>Su gran limitación es que la tabla puede volverse extremadamente grande y no escala bien para discos de gran tamaño.</p>
                <p class="citation">(Tanenbaum & Bos, 2015)</p>

                <h4>ASIGNACIÓN MEDIANTE NODOS-I</h4>
                <p>El sistema de nodos-i (index nodes) asocia con cada archivo un conjunto de atributos y direcciones de bloques organizados de manera jerárquica. El nodo-i solo necesita estar en memoria cuando el archivo está abierto, lo que lo hace altamente escalable y muy utilizado en sistemas como UNIX.</p>
                <p class="citation">(Carretero et al., 2001; Tanenbaum & Bos, 2015)</p>
            </div>
        </div>
        
        <div class="section" id="seccion-4-2-2">
            <div class="section-header">
                <div class="section-number">4.2.2</div>
                <div class="section-title">De Directorios</div>
            </div>
            <div class="content">
                <h3>ESTRUCTURA Y GESTIÓN</h3>
                <p>Los directorios permiten a los usuarios acceder a sus archivos con nombres comprensibles. El sistema operativo traduce estos nombres en direcciones de bloques de datos. Para ello, cada entrada del directorio contiene información que varía según el método de asignación usado (dirección de inicio, número de primer bloque o número de nodo-i).</p>
                <p>Existen dos enfoques para almacenar los atributos del archivo: directamente en la entrada del directorio o en una estructura separada como el nodo-i, siendo este último el método usado en UNIX.</p>
                <div class="figure-container">
                    <img src="FIGURA5.jpg" alt="Diagrama de almacenamiento de atributos." class="imagen-figura5">
                    <div class="figure-caption">Figura 5. Estrategias para almacenar atributos de archivos (basado en Tanenbaum & Bos, 2015). </div>
                </div>

                <h4>MANEJO DE NOMBRES LARGOS</h4>
                <p>Para manejar nombres de archivos largos, se pueden usar entradas de directorio de tamaño variable o, de forma más organizada, mantener los nombres por separado en una estructura llamada "heap", lo que permite mantener las entradas fijas y minimizar problemas de compactación.</p>
                <div class="figure-container">
                    <img src="FIGURA6.jpg" alt="Diagrama de manejo de nombres largos." class="imagen-figura6">
                    <div class="figure-caption">Figura 6. Métodos para manejar nombres largos de archivos (adaptado de Tanenbaum & Bos, 2015). </div>
                </div>
            </div>
        </div>
        
        <div class="section" id="seccion-4-2-3">
            <div class="section-header">
                <div class="section-number">4.2.3</div>
                <div class="section-title">Archivos Compartidos</div>
            </div>
            <div class="content">
                <h3>VÍNCULOS Y ESTRUCTURAS DE GRAFO</h3>
                <p>En muchos entornos, es necesario compartir archivos. Esto se logra haciendo que un mismo archivo aparezca en más de un directorio mediante <span class="highlight">vínculos</span>. Este diseño convierte la estructura jerárquica en un grafo acíclico dirigido (DAG).</p>
                 <p class="citation">(Stallings, 2018)</p>
                 <div class="figure-container">
                    <img src="FIGURA7.jpg" alt="Diagrama de un Grafo Acíclico Dirigido (DAG)." class="imagen-figura7">
                    <div class="figure-caption">Figura 7. Estructura de grafo acíclico dirigido (DAG) (basado en Stallings, 2018). </div>
                </div>

                <h4>TIPOS DE VÍNCULOS</h4>
                <ul>
                    <li><b>Vínculo Duro:</b> Crea una nueva entrada de directorio que apunta directamente al mismo nodo-i del archivo, incrementando su contador de vínculos. El archivo solo se borra cuando este contador llega a cero. Esto evita la pérdida de datos si se elimina el archivo original.</li>
                    <li><b>Vínculo Simbólico:</b> Guarda una ruta de texto que apunta al archivo original. No modifica el nodo-i, pero requiere más procesamiento para seguir la ruta. Permite vincular archivos entre diferentes máquinas, pero el vínculo puede quedar "roto" si el archivo original se elimina.</li>
                </ul>
                <div class="figure-container">
                    <img src="FIGURA8.jpg" alt="Diagrama de gestión de vínculos duros." class="imagen-figura8">
                    <div class="figure-caption">Figura 8. Gestión de vínculos duros y su contador (adaptado de Carretero et al., 2001). </div>
                </div>
            </div>
        </div>
        
        <div class="activity-card" id="actividad-aprendizaje">
            <div class="activity-title"><i class="fas fa-tasks"></i> Actividad de Aprendizaje 2</div>
            <p>Evalúa tu comprensión sobre los métodos de implementación de archivos y directorios en los sistemas de archivos.</p>
            <a href="actividad_4_2.html" class="activity-btn"><i class="fas fa-pencil-alt"></i> Realizar Actividad</a>
        </div>
        
        <div class="nav-buttons">
            <a href="4.1.html" class="nav-btn"><i class="fas fa-arrow-left"></i> Volver a 4.1: Estructura</a>
            <a href="4.3.html" class="nav-btn">Continuar a 4.3: Métodos de Asignación <i class="fas fa-arrow-right"></i></a>
        </div>
        
        <footer>
            <p>Sistemas Operativos - Unidad 4: Sistema de Archivos</p>
            <p>Desarrollado para fines educativos - © 2025 | Referencias: Carretero et al. (2001), Silberschatz et al. (2018), Stallings (2018), Tanenbaum & Bos (2015).</p>
        </footer>
    </div>

    <script>
        let sidebarOpen = false;
        const menuToggle = document.getElementById('menuToggle');
        const sidebarNav = document.getElementById('sidebarNav');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        function toggleSidebar() {
            sidebarOpen = !sidebarOpen;
            sidebarNav.classList.toggle('active');
            sidebarOverlay.classList.toggle('active');
            menuToggle.classList.toggle('active');
            menuToggle.innerHTML = sidebarOpen ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
            document.body.style.overflow = sidebarOpen ? 'hidden' : 'auto';
        }
        menuToggle.addEventListener('click', toggleSidebar);
        sidebarOverlay.addEventListener('click', toggleSidebar);
        document.querySelectorAll('.nav-item[data-section]').forEach(item => {
            item.addEventListener('click', () => { if (window.innerWidth <= 768) toggleSidebar(); });
        });
        function updateActiveSection() {
            const sections = document.querySelectorAll('.section');
            const navItems = document.querySelectorAll('.nav-item[data-section]');
            let currentSection = '';
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 150 && rect.bottom >= 150) currentSection = section.id.replace('seccion-', '');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === currentSection) item.classList.add('active');
            });
        }
        function updateReadingProgress() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            document.getElementById('progressBar').style.width = ((winScroll / height) * 100) + '%';
        }
        const scrollToTopBtn = document.getElementById('scrollToTop');
        function toggleScrollToTopBtn() {
            scrollToTopBtn.classList.toggle('visible', window.pageYOffset > 300);
        }
        scrollToTopBtn.addEventListener('click', () => { window.scrollTo({ top: 0, behavior: 'smooth' }); });
        window.addEventListener('scroll', () => { updateActiveSection(); updateReadingProgress(); toggleScrollToTopBtn(); });
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) window.scrollTo({ top: target.offsetTop - 100, behavior: 'smooth' });
            });
        });
        document.addEventListener('DOMContentLoaded', function() {
            updateActiveSection();
            updateReadingProgress();
            if (window.innerWidth <= 768) sidebarNav.classList.remove('active');
        });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && sidebarOpen) toggleSidebar();
            if ((e.key === 'm' || e.key === 'M') && !e.ctrlKey && !e.altKey) toggleSidebar();
        });
    </script>
</body>
</html>