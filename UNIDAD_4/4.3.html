<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4.3 Métodos de Asignación de Espacio</title>
    <link rel="icon" type="image/png" href="logoescom.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --success: #2ecc71;
            --warning: #f39c12;
            --card-bg: rgba(255, 255, 255, 0.05);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a3a, #2c3e50);
            color: var(--light);
            min-height: 100vh;
            line-height: 1.7;
        }

        .floating-home-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 4px 20px rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            font-size: 1.5rem;
        }

        .floating-home-btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(52, 152, 219, 0.4);
        }

        .sidebar-nav {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 999;
            transition: transform 0.3s ease;
            transform: translateX(-100%);
            overflow-y: auto;
        }

        .sidebar-nav.active {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 20px;
            background: rgba(52, 152, 219, 0.1);
            border-bottom: 1px solid rgba(52, 152, 219, 0.3);
        }

        .sidebar-title {
            font-size: 1.2rem;
            color: var(--secondary);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .nav-sections {
            padding: 20px 0;
        }

        .nav-section {
            margin-bottom: 15px;
        }

        .nav-section-title {
            padding: 10px 20px;
            font-size: 1rem;
            font-weight: 600;
            color: var(--secondary);
            border-bottom: 1px solid rgba(52, 152, 219, 0.2);
            margin-bottom: 10px;
        }

        .nav-item {
            display: block;
            padding: 12px 20px;
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(52, 152, 219, 0.1);
            border-left-color: var(--secondary);
            padding-left: 25px;
        }

        .nav-item.active {
            background: rgba(52, 152, 219, 0.2);
            border-left-color: var(--secondary);
            color: var(--secondary);
        }

        .nav-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 1001;
            font-size: 1.2rem;
        }

        .menu-toggle:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .menu-toggle.active {
            background: var(--accent);
        }

        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 998;
        }

        .reading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--success));
            width: 0%;
            transition: width 0.1s ease;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            transition: margin-left 0.3s ease, margin-right 0.3s ease;
        }
        
        header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .breadcrumb {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            color: var(--gray);
            font-size: 1.1rem;
        }
        
        .breadcrumb a {
            color: var(--secondary);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .breadcrumb a:hover {
            color: white;
            text-decoration: underline;
        }
        
        .breadcrumb span {
            margin: 0 10px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: white;
        }
        
        .subtitle {
            font-size: 1.8rem;
            color: var(--secondary);
            margin-bottom: 20px;
            font-weight: 300;
            text-align: center;
        }
        
        .intro {
            max-width: 900px;
            margin: 0 auto 40px;
            padding: 25px;
            background: var(--card-bg);
            border-radius: 15px;
            border-left: 4px solid var(--secondary);
            text-align: justify;
        }
        
        .section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            scroll-margin-top: 100px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary);
        }
        
        .section-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--secondary);
            margin-right: 15px;
            min-width: 120px;
        }
        
        .section-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: white;
        }
        
        .content {
            padding: 0 10px;
        }
        
        .content h3 {
            font-size: 1.5rem;
            color: var(--secondary);
            margin: 30px 0 15px;
            padding-left: 10px;
            border-left: 3px solid var(--accent);
        }

        .content h4 {
            font-size: 1.3rem;
            color: var(--warning);
            margin: 25px 0 12px;
            padding-left: 8px;
        }
        
        .content p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        .content ul {
            padding-left: 30px;
            margin: 20px 0;
        }

        .content li {
            margin-bottom: 12px;
        }
        
        .citation {
            font-style: italic;
            color: var(--gray);
            margin: 5px 0 15px 20px;
            border-left: 2px solid var(--secondary);
            padding-left: 10px;
        }
        
        .table-container {
            max-width: 800px;
            margin: 30px auto;
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 0, 0, 0.2);
        }
        
        th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .table-caption {
            text-align: center;
            padding: 10px;
            font-style: italic;
            color: var(--gray);
            background: rgba(0, 0, 0, 0.3);
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
        }
        
        .activity-card {
            background: rgba(46, 204, 113, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin: 40px 0;
            border-left: 4px solid var(--success);
            text-align: center;
        }
        
        .activity-title {
            font-size: 1.8rem;
            color: var(--success);
            margin-bottom: 20px;
        }
        
        .activity-btn {
            display: inline-block;
            background: var(--success);
            color: white;
            padding: 15px 35px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }
        
        .activity-btn:hover {
            background: #27ae60;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        
        .nav-btn {
            display: inline-flex;
            align-items: center;
            background: var(--secondary);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
        }
        
        .nav-btn i {
            margin: 0 8px;
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            color: var(--gray);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .scroll-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--accent);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
            transition: all 0.3s ease;
            opacity: 0;
            visibility: hidden;
            z-index: 999;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background: #c0392b;
            transform: translateY(-3px);
        }
        
        @media (max-width: 768px) {
            .sidebar-nav { width: 100%; }
            h1 { font-size: 2rem; }
            .subtitle { font-size: 1.4rem; }
            .section-title { font-size: 1.5rem; }
            .section-number { min-width: 100px; font-size: 1.8rem; }
            .nav-buttons { flex-direction: column; gap: 15px; }
            .nav-btn { width: 100%; text-align: center; justify-content: center; }
            .floating-home-btn { width: 50px; height: 50px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <div class="reading-progress">
        <div class="reading-progress-bar" id="progressBar"></div>
    </div>

    <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>

    <a href="index.html" class="floating-home-btn" title="Ir al inicio de Unidades"><i class="fas fa-home"></i></a>

    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <nav class="sidebar-nav" id="sidebarNav">
        <div class="sidebar-header">
            <div class="sidebar-title">4.3 Métodos de Asignación</div>
            <div class="sidebar-subtitle">Gestión de Espacio en Disco</div>
        </div>
        
        <div class="nav-sections">
            <div class="nav-section">
                <div class="nav-section-title">Navegación</div>
                <a href="#inicio" class="nav-item"><i class="fas fa-play-circle"></i> Inicio de la unidad</a>
                <a href="index.html" class="nav-item"><i class="fas fa-arrow-left"></i> Menú principal</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Contenido</div>
                <a href="#seccion-4-3-1" class="nav-item" data-section="4-3-1"><i class="fas fa-align-left"></i> 4.3.1 Contigua</a>
                <a href="#seccion-4-3-2" class="nav-item" data-section="4-3-2"><i class="fas fa-link"></i> 4.3.2 Ligada</a>
                <a href="#seccion-4-3-3" class="nav-item" data-section="4-3-3"><i class="fas fa-list-ol"></i> 4.3.3 Indexada</a>
                <a href="#seccion-4-3-4" class="nav-item" data-section="4-3-4"><i class="fas fa-hdd"></i> 4.3.4 Administración</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Recursos</div>
                <a href="#actividad-aprendizaje" class="nav-item"><i class="fas fa-tasks"></i> Actividad de aprendizaje</a>
                <a href="4.4.html" class="nav-item"><i class="fas fa-arrow-right"></i> Siguiente: Sistemas Estructurados</a>
            </div>
        </div>
    </nav>

    <button class="scroll-to-top" id="scrollToTop"><i class="fas fa-chevron-up"></i></button>

    <div class="container">
        <header id="inicio">
            <div class="breadcrumb">
                <a href="index.html"><i class="fas fa-home"></i> Inicio</a>
                <span>/</span>
                <a href="index.html">Unidad 4</a>
                <span>/</span>
                <span>4.3 Métodos de Asignación de Espacio</span>
            </div>
            <h1>4.3 Métodos de Asignación de Espacio</h1>
            <div class="subtitle">Estrategias para organizar archivos en el disco</div>
        </header>
        
        <div class="intro">
            <h3>INTRODUCCIÓN</h3>
            <p>Los métodos de asignación de espacio determinan cómo el sistema operativo organiza y administra el almacenamiento de archivos en dispositivos de memoria secundaria. Esta elección impacta directamente en el rendimiento, la eficiencia del espacio y la confiabilidad del sistema.</p>
            <p class="citation">(Tanenbaum & Bos, 2015; Silberschatz et al., 2018)</p>
            <p>Existen tres paradigmas principales, cada uno con características que los hacen apropiados para diferentes escenarios.</p>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>MÉTODO</th>
                            <th>ORGANIZACIÓN</th>
                            <th>VENTAJA PRINCIPAL</th>
                            <th>DESVENTAJA PRINCIPAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Contigua</td>
                            <td>Bloques consecutivos</td>
                            <td>Acceso secuencial óptimo</td>
                            <td>Fragmentación externa</td>
                        </tr>
                        <tr>
                            <td>Ligada</td>
                            <td>Bloques enlazados</td>
                            <td>Aprovechamiento flexible</td>
                            <td>Acceso aleatorio lento</td>
                        </tr>
                        <tr>
                            <td>Indexada</td>
                            <td>Tabla de índices</td>
                            <td>Acceso directo eficiente</td>
                            <td>Overhead de metadatos</td>
                        </tr>
                    </tbody>
                </table>
                <div class="table-caption">Tabla 3. Comparación general de métodos de asignación (adaptado de Silberschatz et al., 2018; Stallings, 2018).</div>
            </div>
        </div>
        
        <div class="section" id="seccion-4-3-1">
            <div class="section-header">
                <div class="section-number">4.3.1</div>
                <div class="section-title">Asignación Contigua</div>
            </div>
            <div class="content">
                <h3>MECANISMO Y VENTAJAS</h3>
                <p>La asignación contigua es el enfoque más directo: almacena todos los bloques de un archivo en posiciones físicamente adyacentes del disco. El sistema operativo solo necesita registrar la dirección de inicio y el tamaño total del archivo para acceder a cualquier parte de su contenido.</p>
                <p class="citation">(Tanenbaum & Bos, 2015; Carretero et al., 2001)</p>
                <p>Las ventajas principales incluyen:</p>
                <ul>
                    <li><b>Acceso secuencial óptimo:</b> La lectura continua minimiza los tiempos de búsqueda del disco.</li>
                    <li><b>Simplicidad de dirección:</b> Solo se requieren dos valores para localizar el archivo.</li>
                    <li><b>Acceso aleatorio eficiente:</b> Cualquier bloque es accesible mediante un cálculo directo.</li>
                </ul>
                <p class="citation">(Silberschatz et al., 2018)</p>
                <h4>PROBLEMÁTICA DE LA FRAGMENTACIÓN EXTERNA</h4>
                <p>Sin embargo, su gran limitación es la <b>fragmentación externa</b>. Con el tiempo, el disco se llena de pequeños huecos no contiguos, lo que dificulta o imposibilita encontrar espacio para archivos nuevos de gran tamaño, aunque el espacio total disponible sea suficiente.</p>
                <p class="citation">(Stallings, 2018; Tanenbaum & Bos, 2015)</p>
            </div>
        </div>
        
        <div class="section" id="seccion-4-3-2">
            <div class="section-header">
                <div class="section-number">4.3.2</div>
                <div class="section-title">Asignación Ligada</div>
            </div>
            <div class="content">
                <h3>FLEXIBILIDAD Y LÍMITES</h3>
                <p>En la asignación ligada, cada bloque del archivo contiene tanto los datos como un puntero al siguiente bloque. El sistema operativo solo necesita mantener la dirección del primer bloque para poder recorrer toda la estructura.</p>
                <p class="citation">(Tanenbaum & Bos, 2015; Carretero et al., 2001)</p>
                <p>Su principal beneficio es la eliminación completa de la fragmentación externa, ya que cualquier bloque libre del disco puede ser utilizado. Además, permite que los archivos crezcan dinámicamente sin problemas.</p>
                <p class="citation">(Silberschatz et al., 2018; Stallings, 2018)</p>
                
                <h4>LIMITACIONES DE RENDIMIENTO</h4>
                <p>No obstante, este método introduce penalizaciones significativas en el rendimiento. El acceso aleatorio se vuelve una operación costosa, ya que requiere seguir la cadena de punteros desde el inicio hasta la posición deseada.</p>
                 <p class="citation">(Tanenbaum & Bos, 2015)</p>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>TIPO DE ACCESO</th>
                                <th>OPERACIONES REQUERIDAS</th>
                                <th>RENDIMIENTO RELATIVO</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Secuencial</td>
                                <td>1 lectura por bloque</td>
                                <td>100% (óptimo)</td>
                            </tr>
                            <tr>
                                <td>Aleatorio (bloque n)</td>
                                <td>n lecturas de punteros + 1 de datos</td>
                                <td>~1/n × 100%</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="table-caption">Tabla 4. Comparación de rendimiento en asignación ligada (elaboración propia basada en Silberschatz et al., 2018).</div>
                </div>
            </div>
        </div>
        
        <div class="section" id="seccion-4-3-3">
            <div class="section-header">
                <div class="section-number">4.3.3</div>
                <div class="section-title">Asignación Indexada</div>
            </div>
            <div class="content">
                <h3>UNA SOLUCIÓN EQUILIBRADA</h3>
                <p>La asignación indexada combina la flexibilidad de la asignación ligada con la eficiencia de la contigua. Utiliza una estructura llamada <b>bloque de índice</b>, que centraliza las direcciones de todos los bloques de datos de un archivo.</p>
                <p class="citation">(Tanenbaum & Bos, 2015; Stallings, 2018)</p>
                <p>El bloque de índice funciona como una tabla de contenidos que permite el acceso directo a cualquier parte del archivo sin necesidad de seguir cadenas de punteros.</p>
                <p>Los beneficios principales incluyen:</p>
                <ul>
                    <li><b>Acceso directo eficiente:</b> Cualquier bloque es accesible en solo dos operaciones de disco (leer índice y leer bloque).</li>
                    <li><b>Flexibilidad de ubicación:</b> Los bloques de datos pueden estar en cualquier parte del disco.</li>
                    <li><b>Buena escalabilidad:</b> Se adapta bien a archivos de diferentes tamaños.</li>
                </ul>
                <p class="citation">(Silberschatz et al., 2018)</p>
                <h4>CONSIDERACIONES DE OVERHEAD</h4>
                <p>La principal desventaja es el <b>overhead de metadatos</b>, ya que cada archivo requiere al menos un bloque adicional para su índice, lo cual puede ser ineficiente para archivos muy pequeños.</p>
                <p class="citation">(Stallings, 2018)</p>
            </div>
        </div>

        <div class="section" id="seccion-4-3-4">
            <div class="section-header">
                <div class="section-number">4.3.4</div>
                <div class="section-title">Administración del Espacio en Disco</div>
            </div>
            <div class="content">
                <h3>TAMAÑO DE BLOQUE</h3>
                <p>Una vez decidido dividir los archivos en bloques de tamaño fijo, surge la duda sobre la medida adecuada. Elegir el tamaño del bloque es un equilibrio crucial:</p>
                <ul>
                    <li>Un <b>bloque demasiado grande</b> desperdicia espacio en disco (fragmentación interna), ya que incluso un archivo pequeño ocupará todo el bloque.</li>
                    <li>Un <b>bloque demasiado pequeño</b> desperdicia tiempo, pues un archivo común se dividirá en muchos fragmentos, requiriendo más búsquedas y retrasos en la lectura.</li>
                </ul>
                <h4>REGISTRO DE BLOQUES LIBRES</h4>
                <p>Para llevar el control de los bloques que están libres, existen varios métodos. Uno de los más comunes es usar una <b>lista enlazada de bloques de disco</b>, donde cada bloque de la lista almacena la mayor cantidad posible de números que identifican a otros bloques libres, enlazándose con el siguiente bloque de la lista para continuar el registro.</p>
            </div>
        </div>
        
        <div class="activity-card" id="actividad-aprendizaje">
            <div class="activity-title"><i class="fas fa-tasks"></i> Actividad de Aprendizaje 3</div>
            <p>Comprueba tu conocimiento sobre las ventajas, desventajas y mecanismos de los diferentes métodos de asignación de espacio en disco.</p>
            <a href="actividad_4_3.html" class="activity-btn"><i class="fas fa-pencil-alt"></i> Realizar Actividad</a>
        </div>
        
        <div class="nav-buttons">
            <a href="4.2.html" class="nav-btn"><i class="fas fa-arrow-left"></i> Volver a 4.2: Implementación</a>
            <a href="4.4.html" class="nav-btn">Continuar a 4.4: Sistemas Estructurados <i class="fas fa-arrow-right"></i></a>
        </div>
        
        <footer>
            <p>Sistemas Operativos - Unidad 4: Sistema de Archivos</p>
            <p>Desarrollado para fines educativos - © 2025 | Referencias: Carretero et al. (2001), Silberschatz et al. (2018), Stallings (2018), Tanenbaum & Bos (2015).</p>
        </footer>
    </div>

    <script>
        let sidebarOpen = false;
        const menuToggle = document.getElementById('menuToggle');
        const sidebarNav = document.getElementById('sidebarNav');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        function toggleSidebar() {
            sidebarOpen = !sidebarOpen;
            sidebarNav.classList.toggle('active');
            sidebarOverlay.classList.toggle('active');
            menuToggle.classList.toggle('active');
            menuToggle.innerHTML = sidebarOpen ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
            document.body.style.overflow = sidebarOpen ? 'hidden' : 'auto';
        }
        menuToggle.addEventListener('click', toggleSidebar);
        sidebarOverlay.addEventListener('click', toggleSidebar);
        document.querySelectorAll('.nav-item[data-section]').forEach(item => {
            item.addEventListener('click', () => { if (window.innerWidth <= 768) toggleSidebar(); });
        });
        function updateActiveSection() {
            const sections = document.querySelectorAll('.section');
            const navItems = document.querySelectorAll('.nav-item[data-section]');
            let currentSection = '';
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 150 && rect.bottom >= 150) currentSection = section.id.replace('seccion-', '');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === currentSection) item.classList.add('active');
            });
        }
        function updateReadingProgress() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            document.getElementById('progressBar').style.width = ((winScroll / height) * 100) + '%';
        }
        const scrollToTopBtn = document.getElementById('scrollToTop');
        function toggleScrollToTopBtn() {
            scrollToTopBtn.classList.toggle('visible', window.pageYOffset > 300);
        }
        scrollToTopBtn.addEventListener('click', () => { window.scrollTo({ top: 0, behavior: 'smooth' }); });
        window.addEventListener('scroll', () => { updateActiveSection(); updateReadingProgress(); toggleScrollToTopBtn(); });
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) window.scrollTo({ top: target.offsetTop - 100, behavior: 'smooth' });
            });
        });
        document.addEventListener('DOMContentLoaded', function() {
            updateActiveSection();
            updateReadingProgress();
            if (window.innerWidth <= 768) sidebarNav.classList.remove('active');
        });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && sidebarOpen) toggleSidebar();
            if ((e.key === 'm' || e.key === 'M') && !e.ctrlKey && !e.altKey) toggleSidebar();
        });
    </script>
</body>
</html>